CREATE DATABASE gestrator;

CREATE TABLE login (
    id_login int auto_increment PRIMARY KEY,
    usuario varchar(30),
    email varchar(90),
    senha varchar(255),
    tipo varchar(10)
);

CREATE TABLE setor (
    id_setor int auto_increment PRIMARY KEY,
    nome_setor varchar(60),
    quantidade int
); 

CREATE TABLE servico (
    id_servico int auto_increment PRIMARY KEY,
    nome_servico Varchar(50),
    descricao Varchar(50),
    data_criada date,
    data_final date,
    situacao Varchar(20),
    prioridade Varchar(20),
    equipe text,
    id_setor int,
    FOREIGN KEY(id_setor) REFERENCES Setor (id_setor)
);

CREATE TABLE funcionario (
    id_funcionario int auto_increment PRIMARY KEY,
    nome_funcionario varchar(90),
    nacionalidade varchar(20),
    data_nascimento date,
    cargo varchar(40),
    salario float,
    cpf char(13),
    rg varchar(16),
    email text,
    celular varchar(16),
    cidade varchar(20),
    endereco varchar(60),
    pcd varchar(16),
    foto_funcionario blob,
    id_setor int,
    id_login int,
    FOREIGN KEY (id_setor) REFERENCES setor (id_setor) ON DELETE CASCADE,
    FOREIGN KEY (id_login) REFERENCES login (id_login) ON DELETE CASCADE
);

CREATE TABLE conteudo (
    id_conteudo int auto_increment PRIMARY KEY,
    nome_conteudo varchar(30),
    descricao varchar(30),
    pdf longblob,
    capa blob,
    id_setor int,
    FOREIGN KEY (id_setor) REFERENCES setor (id_setor) ON DELETE CASCADE
);

CREATE TABLE comentario (
    id_comentario int auto_increment PRIMARY KEY,
    comentario text,
    id_funcionario int,
    id_servico int,
    FOREIGN KEY (id_funcionario) REFERENCES funcionario (id_funcionario) ON DELETE CASCADE,
    FOREIGN KEY (id_servico) REFERENCES servico (id_servico) ON DELETE CASCADE
);


INSERT INTO setor(nome_setor, quantidade) VALUES('Administrativo' ,0);
INSERT INTO setor(nome_setor, quantidade) VALUES('Comercial' ,0);
INSERT INTO setor(nome_setor, quantidade) VALUES('Marketing' ,0);
INSERT INTO setor(nome_setor, quantidade) VALUES('Financeiro' ,0);
INSERT INTO setor(nome_setor, quantidade) VALUES('Compras' ,0);
INSERT INTO setor(nome_setor, quantidade) VALUES('Recursos humanos' ,0);
INSERT INTO setor(nome_setor, quantidade) VALUES('Operações' ,0);